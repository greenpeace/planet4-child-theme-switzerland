!function(){function t(t){if(t&&!t.dataset.fqInitialized){t.dataset.fqInitialized="1";try{const a=JSON.parse(t.getAttribute("data-breakfast-meals")||"[]"),l=JSON.parse(t.getAttribute("data-lunch-meals")||"[]"),i=JSON.parse(t.getAttribute("data-dinner-meals")||"[]"),o=JSON.parse(t.getAttribute("data-drinks")||"[]"),s=JSON.parse(t.getAttribute("data-tier-thresholds")||"[]"),c=JSON.parse(t.getAttribute("data-tier-labels")||"[]"),d=["breakfast","lunch","dinner"],u=t.querySelector(".food-quiz__meal-times"),f=t.querySelector(".food-quiz__drinks"),m=t.querySelector(".food-quiz__calculate"),p=t.querySelector(".food-quiz__result-output");let h=null;const b=300;let y=!1;function e(){if(!m)return void n();if(m.querySelector(".fq-spinner"))return void setTimeout(()=>{n()},500);const t=document.createElement("span");t.className="fq-spinner",t.setAttribute("aria-hidden","true"),t.style.display="inline-block",t.style.marginLeft="0.5rem",t.innerHTML='\n\t\t\t\t\t<svg width="16" height="16" viewBox="0 0 50 50" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t\t\t<circle cx="25" cy="25" r="20" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round" stroke-dasharray="31.4 31.4">\n\t\t\t\t\t\t\t<animateTransform attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.7s" repeatCount="indefinite" />\n\t\t\t\t\t\t</circle>\n\t\t\t\t\t</svg>\n\t\t\t\t',m.appendChild(t),m.setAttribute("aria-busy","true"),setTimeout(()=>{try{n()}finally{const t=m.querySelector(".fq-spinner");t&&t.remove(),m.removeAttribute("aria-busy"),m.disabled=!0}},500)}function r(){y&&(h&&clearTimeout(h),h=setTimeout(()=>{try{e()}catch(t){}},b))}function n(){let e=0;const r={breakfast:null,lunch:null,dinner:null};d.forEach(n=>{const o=t.querySelector(`input[name="fq-${n}"]:checked`);if(o){const t=parseInt(o.value,10),s="breakfast"===n?a:"lunch"===n?l:i;s[t]&&(r[n]=s[t].title||`Option ${t+1}`,s[t].score&&(e+=Number(s[t].score)))}});const n=[];t.querySelectorAll(".fq-drink-input").forEach(t=>{const r=parseInt(t.getAttribute("data-index"),10),a=Number(t.value)||0;o[r]&&(n[r]=a,o[r].score&&(e+=a*Number(o[r].score)))});const c=Math.max(0,...a.map(t=>Number(t.score)||0))+Math.max(0,...l.map(t=>Number(t.score)||0))+Math.max(0,...i.map(t=>Number(t.score)||0))+10*o.reduce((t,e)=>t+(Number(e.score)||0),0);let u=4;if(Array.isArray(s)&&s.length)for(let t=0;t<Math.min(4,s.length);t++){const r=s[t];if("number"==typeof r&&!Number.isNaN(r)&&e<=r){u=t;break}}else{const t=c>0?e/c:0;u=Math.min(4,Math.floor(5*t))}let f=!0;if(d.forEach(e=>{t.querySelector(`input[name="fq-${e}"]:checked`)||(f=!1)}),p){p.querySelectorAll(".food-quiz__tier").forEach(t=>t.style.display="none");const t=p.querySelector(".error-message"),a=p.querySelector(".result-scale");if(f){t&&(t.style.display="none"),a&&(a.style.display="block");const l=p.querySelector(`.food-quiz__tier[data-tier="${u}"]`);l&&(l.style.display="block");try{!function(t){const e=p&&p.querySelector(".result-scale");if(!e)return;const r=e.querySelectorAll(".result-scale__tier"),n=e.querySelector(".result-scale__arrow");if(!r.length||!n)return;const a=r[Math.max(0,Math.min(r.length-1,t))],l=e.getBoundingClientRect(),i=a.getBoundingClientRect(),o=i.left-l.left+i.width/2;n.style.transform=`translateX(${Math.round(o)}px)`}(u)}catch(t){}if(m&&(m.disabled=!0),void 0!==window.dataLayer){const t={};n.forEach((e,r)=>{t[`drink_${r+1}`]=e||0}),window.dataLayer.push({event:"food_quiz_calculated",food_quiz:{total_score:e,result_tier:u+1,breakfast_meal:r.breakfast,lunch_meal:r.lunch,dinner_meal:r.dinner,...t}})}}else t&&(t.style.display="block"),a&&(a.style.display="none"),m&&(m.disabled=!1)}}!function(){if(!p)return null;const t=p.querySelector(".result-scale");if(!t)return null;if(t.dataset.fqScaleInit)return t;t.dataset.fqScaleInit="1",t.innerHTML="";const e=document.createElement("div");e.className="result-scale__row";for(let t=0;t<5;t++){const r=document.createElement("div");r.className=`result-scale__tier result-scale__tier--${t}`,r.setAttribute("data-tier",String(t)),r.setAttribute("aria-hidden","true");const n=Array.isArray(c)&&c[t]?c[t]:`Tier ${t+1}`,a=document.createElement("span");a.className="result-scale__label",a.textContent=n,r.appendChild(a),e.appendChild(r)}const r=document.createElement("div");r.className="result-scale__arrow",r.setAttribute("aria-hidden","true"),t.appendChild(r),t.appendChild(e)}(),function(){if(u&&(d.forEach(t=>{const e=u.querySelector(`.food-quiz__meal[data-time="${t}"]`);if(!e)return;e.innerHTML="<h3>"+e.dataset.title+"</h3>";const n=document.createElement("div");n.className="food-quiz__meal-options",e.appendChild(n),("breakfast"===t?a:"lunch"===t?l:i).forEach((e,a)=>{const l=document.createElement("label");l.className="fq-option",l.innerHTML=`\n\t\t\t\t\t\t\t\t<input type="radio" name="fq-${t}" value="${a}" ${0===a&&"breakfast"===t?"checked":""} />\n\t\t\t\t\t\t\t\t<p class="fq-option-title">${e.title}</p>\n\t\t\t\t\t\t\t\t<div class="fq-option-img">${e.imageUrl?`<img src="${e.imageUrl}" alt=""/>`:""}</div>\n\t\t\t\t\t\t\t`,n.appendChild(l);const i=l.querySelector('input[type="radio"]');i&&i.addEventListener("change",()=>{m&&(m.disabled=!1),y&&r()})})}),f)){f.innerHTML="<h3>"+f.dataset.title+"</h3>";const t=document.createElement("div");t.className="food-quiz__drink-options",f.appendChild(t),o.forEach((e,n)=>{const a=document.createElement("div");a.className="fq-drink-wrapper",a.innerHTML=`\n\t\t\t\t\t\t\t<label class="fq-drink-label">\n\t\t\t\t\t\t\t\t<p class="fq-option-title">${e.title}</p>\n\t\t\t\t\t\t\t\t<div class="fq-drink-controls">\n\t\t\t\t\t\t\t\t\t<button type="button" class="fq-drink-decrease" aria-label="Decrease">âˆ’</button>\n\t\t\t\t\t\t\t\t\t<input type="number" min="0" max="5" value="0" data-index="${n}" class="fq-drink-input" />\n\t\t\t\t\t\t\t\t\t<button type="button" class="fq-drink-increase" aria-label="Increase">+</button>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</label>`,t.appendChild(a);const l=a.querySelector(".fq-drink-input"),i=a.querySelector(".fq-drink-decrease"),o=a.querySelector(".fq-drink-increase");i&&l&&i.addEventListener("click",()=>{let t=Number(l.value)||0;t=Math.max(0,t-1),l.value=t,l.dispatchEvent(new Event("input",{bubbles:!0}))}),o&&l&&o.addEventListener("click",()=>{let t=Number(l.value)||0;t=Math.min(10,t+1),l.value=t,l.dispatchEvent(new Event("input",{bubbles:!0}))}),l&&l.addEventListener("input",()=>{m&&(m.disabled=!1),y&&r()})})}}(),m&&m.addEventListener("click",()=>{y=!0,h&&clearTimeout(h),e()}),p&&p.querySelectorAll(".food-quiz__tier").forEach(t=>t.style.display="none")}catch(q){}}}function e(){document.querySelectorAll(".wp-block-planet4-child-theme-switzerland-food-quiz, .food-quiz").forEach(t)}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",e):e(),new MutationObserver(e=>{e.forEach(e=>{e.addedNodes.forEach(e=>{1===e.nodeType&&(e.matches&&(e.matches(".wp-block-planet4-child-theme-switzerland-food-quiz")||e.matches(".food-quiz"))?t(e):e.querySelectorAll&&e.querySelectorAll(".wp-block-planet4-child-theme-switzerland-food-quiz, .food-quiz").forEach(t))})})}).observe(document.body||document.documentElement,{childList:!0,subtree:!0})}();